# OneScript-BackgroundJobs

Внешняя компонента, реализующая фоновые задания в http-сервисах OneScript.

## Компиляция

Скомпилированные версии библиотеки можно загрузить по [ссылке](https://github.com/jdeshin/OneScript-BackgroundJobs/releases).
Если Вы хотите самостоятельно скомпилировать библиотеку, необходимо скопировать dll файлы из дистрибутива OneScript в папку OneScript.
Дистрибутив можно скачать по ссылке (http://oscript.io/downloads)[http://oscript.io/downloads].

## Установка

1. Скопируйте файл WebBackgroundJobs.dll в папку Bin Вашего web-приложения.
2. Добавьте ключ:

```
<add key="WebBackgroundJobs" value="attachAssembly" />
```

в раздел appSettings, файла web.config

## Использование

В настоящее время реализованы методы Выполнить и ОжидатьЗавершения. Их использование и поведение аналогично соответствующим функциям в платформе 1С:Предприятие. 

```bsl
	ФоновыеЗадания = Новый МенеджерФоновыхЗаданийWeb;
	
	// Создаем параметры фонового задания
	МассивПараметров = Новый Массив;
	МассивПараметров.Добавить("Это содержимое файла");
	
	// Запускаем фоновое задание на выполнение
	МоеЗадание = ФоновыеЗадания.Выполнить("Тестовый.ТестовоеФЗ", МассивПараметров);
	
	// Дожидаемся завершения фонового задания
	МассивЗаданий = Новый Массив;
	МассивЗаданий.Добавить(МоеЗадание);
	ФоновыеЗадания.ОжидатьЗавершения(МассивЗаданий);

```

В процессе выполнения метода ОжидатьЗавершения, производится периодическая проверка фоновых заданий на предмет их завершения. По умолчанию, интервал проверки составляет 1000 мс.
Для изменения этого интервала, необходимо в раздел appSettings, файла web.config, добавить нижеследующий ключ:

```
<add key="jobsCheckInterval" value="2000" />
``` 

где value - желаемое значение интервала в миллисекундах.
